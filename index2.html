<!DOCTYPE html>
<html>
<head>
	<title>WebSocket Toggle Switch</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
	<h1>WebSocket Toggle Switch</h1>
	<label for="toggle">Toggle Switch:</label>
	<input type="checkbox" id="toggle">
	<script >
const ws = new WebSocket('ws://localhost:8899/devices/');

ws.addEventListener('open', () => {
  console.log('WebSocket connection established!');
});

ws.addEventListener('message', (event) => {
  const data = JSON.parse(event.data);
  const devicesDiv = document.getElementById('devices');
  devicesDiv.innerHTML = '';

  data.forEach(device => {
    const { device_name, device_status } = device;

    const deviceDiv = document.createElement('div');
    const nameLabel = document.createElement('label');
    nameLabel.textContent = device_name;
    const toggleInput = document.createElement('input');
    toggleInput.type = 'checkbox';
    toggleInput.checked = device_status === 'true';

    toggleInput.addEventListener('change', () => {
      const toggleState = toggleInput.checked;
      const data = JSON.stringify({ device_name, device_status: toggleState.toString() });
      ws.send(data);
    });

    deviceDiv.appendChild(nameLabel);
    deviceDiv.appendChild(toggleInput);
    devicesDiv.appendChild(deviceDiv);
  });
});

  </script>
</body>
</html>